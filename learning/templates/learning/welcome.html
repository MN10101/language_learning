{% extends 'base.html' %}

{% load static %}

{% block title %}Welcome{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/welcome.css' %}">

<div class="welcome-container">
    <!-- Profile section -->
    <div class="profile-section animated fade-in-center">
        {% if profile.profile_picture %}
            <img src="{{ profile.profile_picture.url }}" class="profile-picture" alt="Profile Picture">
        {% else %}
            <img src="{% static 'default_profile_picture.jpg' %}" class="profile-picture" alt="Default Profile Picture">
        {% endif %}
        <h1>Welcome, {{ profile.first_name }} {{ profile.last_name }}!</h1>
    </div>

    <!-- Introduction section -->
    <div class="info-section animated fade-in-center">
        <p>We are thrilled to welcome you to our advanced education platform, where you can accelerate your learning journey and achieve new heights. Our system is meticulously crafted to offer a comprehensive learning experience, personalized to your needs, whether you're enhancing your English language skills or preparing for important exams.</p>
        <p>We believe that learning should be engaging, efficient, and effective. That’s why our platform offers tailored assessments that cater to a wide range of proficiency levels. You’ll receive personalized feedback, helping you focus on areas that need improvement while celebrating your strengths.</p>
        <p>Explore our interactive learning tools, participate in discussions with fellow learners, and track your progress as you work towards your goals. We are here to support you every step of the way!</p>
        <button id="englishTestButton" class="btn">English Test</button>
        <button id="itSkillsTestButton" class="btn">IT Skills Test</button>

        <!-- Animated down arrow -->
        <div class="arrow-container">
            <div class="arrow"></div>
        </div>
    </div>

    


    <!-- Image section with custom images and animation -->
    <div class="image-section">
        <div class="image-text-pair">
            <div class="image-container animated slide-in-left">
                <img src="{% static 'images/1.jpg' %}" alt="Learning Image 1" class="info-image">
            </div>
            <div class="text-container animated slide-in-right">
                <p>Interactive and adaptive lessons designed to align with your learning preferences. Engage with immersive content that adapts to your learning style, ensuring that each lesson is impactful and enjoyable.</p>
            </div>
        </div>
        <div class="image-text-pair">
            <div class="image-container animated slide-in-left">
                <img src="{% static 'images/2.jpg' %}" alt="Learning Image 2" class="info-image">
            </div>
            <div class="text-container animated slide-in-right">
                <p>Track your progress with detailed insights and personalized feedback. Our system continuously evaluates your learning curve, offering suggestions for improvement while recognizing your achievements.</p>
            </div>
        </div>
        <div class="image-text-pair">
            <div class="image-container animated slide-in-left">
                <img src="{% static 'images/3.jpg' %}" alt="Learning Image 3" class="info-image">
            </div>
            <div class="text-container animated slide-in-right">
                <p>Become part of a thriving community of learners. Share your experiences, collaborate with peers, and grow together in a supportive environment designed for collective success.</p>
            </div>
        </div>
    </div>
</div>

<!-- Add the hidden video element -->
<video id="welcomeVideo" class="fullscreen-video" src="{% static 'vid/je.mp4' %}" style="display:none;"></video>

<!-- Close button -->
<button id="closeVideo" style="display:none;">X</button>

<!-- JavaScript to handle video playback and animations -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const video = document.getElementById('welcomeVideo');
        const closeButton = document.getElementById('closeVideo');
        const hasWatchedVideo = localStorage.getItem('hasWatchedVideo');
        const hasClosedVideo = localStorage.getItem('hasClosedVideo'); // New flag

        function playVideo() {
            if (!hasClosedVideo) { // Check if the video has been closed before
                video.style.display = 'block';  // Show the video
                closeButton.style.display = 'block'; // Show the close button
                video.play();  // Play the video with sound

                // Once the video ends, hide it and mark it as watched
                video.onended = function () {
                    video.style.display = 'none';
                    closeButton.style.display = 'none'; // Hide the close button
                    localStorage.setItem('hasWatchedVideo', 'true');  // Store in localStorage to play only once
                };

                // Remove the event listener after the first interaction
                document.removeEventListener('click', playVideo);
            }
        }

        document.getElementById('englishTestButton').addEventListener('click', function() {
        window.location.href = "{% url 'english_test' %}";
        });

        document.getElementById('itSkillsTestButton').addEventListener('click', function() {
            window.location.href = "{% url 'it_test' %}";
        });

        // Check if the video has been watched or closed before
        if (!hasWatchedVideo && !hasClosedVideo) {
            document.addEventListener('click', playVideo); // Wait for user interaction
        }

        // Close video function
        closeButton.addEventListener('click', function() {
            video.style.display = 'none';  // Hide the video
            closeButton.style.display = 'none'; // Hide the close button
            video.pause();  // Pause the video
            localStorage.setItem('hasClosedVideo', 'true'); // Set flag that video has been closed
        });

        const animatedElements = document.querySelectorAll('.animated');

        function checkScroll() {
            animatedElements.forEach(element => {
                const position = element.getBoundingClientRect().top;
                const screenPosition = window.innerHeight / 1.4;

                if (position < screenPosition) {
                    element.classList.add('show');
                }
            });
        }

        window.addEventListener('scroll', checkScroll);
        checkScroll(); // Run on page load
    });
</script>


{% endblock %}
